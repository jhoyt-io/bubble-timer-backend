---
description: "Test Failure Handling - Guidelines for handling test failures"
globs: ["__tests__/**/*", "**/*.test.ts", "**/*.test.js"]
alwaysApply: false
---

# Test Failure Handling

When working with test files:
- If tests are failing at the end of an attempt to satisfy a prompt, call this out clearly
- Do NOT celebrate completion or suggest continuing when tests are still failing
- Propose specific options for fixing the failing tests
- Focus on resolving test failures before proceeding with other work
- Suggest debugging steps, test isolation, or specific fixes for the failing tests

## Debugging Test Failures

### Common Patterns
1. **Mock Not Called**: Check setup, verify code path, add debug logging
2. **Unexpected Mock Calls**: Review setup, check for side effects, verify test isolation
3. **Assertion Failures**: Check expected vs actual values, verify test data
4. **Async Test Issues**: Ensure proper async/await usage, check for unhandled promises

### Key Checks
- **Test Structure**: Given-When-Then pattern, proper setup placement
- **Mock Configuration**: Correct setup, reset in beforeEach/afterEach
- **Test Data**: Matches expected formats, realistic scenarios
- **Test Isolation**: No shared state, clean mocks between tests
